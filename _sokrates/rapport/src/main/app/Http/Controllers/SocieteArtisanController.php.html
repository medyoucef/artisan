<html>
<head>
    <title>app/Http/Controllers/SocieteArtisanController.php</title>
    <style type="text/css" media="screen">
        #editor {
            position: absolute;
            top: 40px;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body style="font-family: 'DejaVu Sans', Arial, Helvetica, sans-serif">
<h3 style="margin-bottom: 0">app/Http/Controllers/SocieteArtisanController.php (<b>34</b> lines of code) (<a href="SocieteArtisanController.php">raw</a>):</h3>
<div id="editor">&lt;?php

namespace App\Http\Controllers;
use Illuminate\Support\Facades\DB;
use Illuminate\Http\Request;
use App\Models\SocieteArtisan;
class SocieteArtisanController extends Controller
{
    public function index(Request $request)
    {
        $societes = $this-&gt;filterSocietes($request);
        return view('front.art_soc', compact('societes'));
    }

    public function search(Request $request)
{
    $query = SocieteArtisan::query();

    if ($request-&gt;has('adresse') &amp;&amp; !empty($request-&gt;adresse)) {
        $query-&gt;where('adresse', 'like', '%' . $request-&gt;adresse . '%');
    }

    $societes = $query-&gt;get();

    $html = view('partials.societes_liste', compact('societes'))-&gt;render();

    return response()-&gt;json(['html' =&gt; $html]);
}


    

    private function filterSocietes(Request $request)
    {
        $query = DB::table('societe_artisan');

        if ($request-&gt;filled('name')) {
            $query-&gt;where('name', 'like', '%' . $request-&gt;name . '%');
        }

        if ($request-&gt;filled('ville')) {
            $query-&gt;where('ville', 'like', '%' . $request-&gt;ville . '%'); // ou une vraie colonne `ville` si elle existe
        }

        return $query-&gt;get();
    }
    
}
</div>
<script src="https://www.zeljkoobrenovic.com/tools/common/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.session.setMode("ace/mode/php");
    editor.setTheme("ace/theme/xcode");
    editor.setReadOnly(true);
    editor.setOption("wrap", true);
    editor.setPrintMarginColumn(120);
</script>
</body>
